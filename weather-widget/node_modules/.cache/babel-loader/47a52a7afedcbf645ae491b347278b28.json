{"ast":null,"code":"import { Size } from './components.js';\nimport { f as _slicedToArray, i as _toConsumableArray, g as getRootClassName, a as _objectWithoutProperties, b as _extends, d as classnames, h as handleBasicClasses, D as DIALOG_TRANSITION_DURATION } from './getRootClassName.js';\nimport React, { useState, useEffect, forwardRef, useRef, useMemo, Children } from 'react';\nimport { D as DOCUMENT } from './constants.js';\nimport { p as partitionMulti } from './partitionMulti.js';\nimport { i as isComponent } from './type.js';\nimport { m as mergeRefs } from './mergeRefs.js';\nimport { u as useFocusTrap } from './useFocusTrap.js';\nimport { createPortal } from 'react-dom';\nimport { u as useCallbackOnEscape, C as ClickAwayProvider } from './ClickAwayProvider.js';\nimport { u as useDelayedVisibility } from './useDelayedVisibility.js';\nimport { u as useDisableBodyScroll } from './useDisableBodyScroll.js';\nimport { a as Progress, P as ProgressVariant } from './Progress2.js';\n/**\n * Convenient hook to create interaction observers.\n *\n * @param elements Elements to observe.\n * @param options  IntersectionObserver options.\n * @return Map of intersections.\n */\n\nfunction useIntersectionObserver(elements, options) {\n  var _useState = useState(function () {\n    return new Map();\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      intersections = _useState2[0],\n      setIntersections = _useState2[1];\n\n  useEffect(function () {\n    if (elements.length < 1 || !elements.some(Boolean)) {\n      return undefined;\n    }\n\n    var observer = new IntersectionObserver(function (entries) {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = entries[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var entry = _step.value;\n          intersections.set(entry.target, entry);\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      setIntersections(new Map(intersections));\n    }, options);\n    var _iteratorNormalCompletion2 = true;\n    var _didIteratorError2 = false;\n    var _iteratorError2 = undefined;\n\n    try {\n      for (var _iterator2 = elements[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n        var element = _step2.value;\n\n        if (element) {\n          observer.observe(element);\n        }\n      }\n    } catch (err) {\n      _didIteratorError2 = true;\n      _iteratorError2 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n          _iterator2.return();\n        }\n      } finally {\n        if (_didIteratorError2) {\n          throw _iteratorError2;\n        }\n      }\n    }\n\n    return function () {\n      return observer.disconnect();\n    };\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  _toConsumableArray(elements));\n  return intersections;\n}\n/**\n * Defines the props of the component.\n */\n\n\nvar isHeader = isComponent('header');\nvar isFooter = isComponent('footer');\n/**\n * Component display name.\n */\n\nvar COMPONENT_NAME = 'Dialog';\n/**\n * Component default class name and class prefix.\n */\n\nvar CLASSNAME = getRootClassName(COMPONENT_NAME);\n/**\n * Component default props.\n */\n\nvar DEFAULT_PROPS = {\n  size: Size.big\n};\n/**\n * Dialog component.\n *\n * @param  props Component props.\n * @param  ref   Component ref.\n * @return React element.\n */\n\nvar Dialog = forwardRef(function (props, ref) {\n  var _ref, _intersections$get, _ref2, _intersections$get2, _ref3, _ref4;\n\n  if (!DOCUMENT) {\n    // Can't render in SSR.\n    return null;\n  }\n\n  var children = props.children,\n      className = props.className,\n      header = props.header,\n      focusElement = props.focusElement,\n      forceFooterDivider = props.forceFooterDivider,\n      forceHeaderDivider = props.forceHeaderDivider,\n      footer = props.footer,\n      isLoading = props.isLoading,\n      isOpen = props.isOpen,\n      onClose = props.onClose,\n      parentElement = props.parentElement,\n      contentRef = props.contentRef,\n      preventAutoClose = props.preventAutoClose,\n      size = props.size,\n      zIndex = props.zIndex,\n      dialogProps = props.dialogProps,\n      onVisibilityChange = props.onVisibilityChange,\n      forwardedProps = _objectWithoutProperties(props, [\"children\", \"className\", \"header\", \"focusElement\", \"forceFooterDivider\", \"forceHeaderDivider\", \"footer\", \"isLoading\", \"isOpen\", \"onClose\", \"parentElement\", \"contentRef\", \"preventAutoClose\", \"size\", \"zIndex\", \"dialogProps\", \"onVisibilityChange\"]);\n\n  var handleClose = onClose ? function () {\n    onClose(); // Focus the parent element on close.\n\n    if (parentElement && parentElement.current) {\n      parentElement.current.focus();\n    }\n  } : undefined; // eslint-disable-next-line react-hooks/rules-of-hooks\n\n  useCallbackOnEscape(handleClose, isOpen && !preventAutoClose); // eslint-disable-next-line react-hooks/rules-of-hooks\n\n  var wrapperRef = useRef(null);\n  /**\n   * Since the `contentRef` comes from the parent and is optional,\n   * we need to create a stable contentRef that will always be available.\n   */\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n\n  var localContentRef = useRef(null); // Handle focus trap.\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n\n  useFocusTrap(wrapperRef.current, focusElement === null || focusElement === void 0 ? void 0 : focusElement.current); // eslint-disable-next-line react-hooks/rules-of-hooks\n\n  useDisableBodyScroll(isOpen && localContentRef.current); // eslint-disable-next-line react-hooks/rules-of-hooks\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      sentinelTop = _useState2[0],\n      setSentinelTop = _useState2[1]; // eslint-disable-next-line react-hooks/rules-of-hooks\n\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      sentinelBottom = _useState4[0],\n      setSentinelBottom = _useState4[1]; // eslint-disable-next-line react-hooks/rules-of-hooks\n\n\n  var intersections = useIntersectionObserver([sentinelTop, sentinelBottom], {\n    threshold: [0, 1]\n  });\n  var hasTopIntersection = sentinelTop && !((_ref = (_intersections$get = intersections.get(sentinelTop)) === null || _intersections$get === void 0 ? void 0 : _intersections$get.isIntersecting) !== null && _ref !== void 0 ? _ref : true);\n  var hasBottomIntersection = sentinelBottom && !((_ref2 = (_intersections$get2 = intersections.get(sentinelBottom)) === null || _intersections$get2 === void 0 ? void 0 : _intersections$get2.isIntersecting) !== null && _ref2 !== void 0 ? _ref2 : true); // Separate header, footer and dialog content from children.\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n\n  var _useMemo = useMemo(function () {\n    return partitionMulti(Children.toArray(children), [isHeader, isFooter]);\n  }, [children]),\n      _useMemo2 = _slicedToArray(_useMemo, 3),\n      _useMemo2$ = _slicedToArray(_useMemo2[0], 1),\n      headerChild = _useMemo2$[0],\n      _useMemo2$2 = _slicedToArray(_useMemo2[1], 1),\n      footerChild = _useMemo2$2[0],\n      content = _useMemo2[2];\n\n  var headerChildProps = (_ref3 = headerChild) === null || _ref3 === void 0 ? void 0 : _ref3.props;\n  var headerChildContent = headerChildProps === null || headerChildProps === void 0 ? void 0 : headerChildProps.children;\n  var footerChildProps = (_ref4 = footerChild) === null || _ref4 === void 0 ? void 0 : _ref4.props;\n  var footerChildContent = footerChildProps === null || footerChildProps === void 0 ? void 0 : footerChildProps.children; // eslint-disable-next-line react-hooks/rules-of-hooks\n\n  var isVisible = useDelayedVisibility(Boolean(isOpen), DIALOG_TRANSITION_DURATION, onVisibilityChange); // eslint-disable-next-line react-hooks/rules-of-hooks\n\n  var clickAwayRefs = useRef([wrapperRef]);\n  return isOpen || isVisible ? createPortal(React.createElement(\"div\", _extends({\n    ref: ref\n  }, forwardedProps, {\n    className: classnames(className, handleBasicClasses({\n      isHidden: !isOpen,\n      isLoading: isLoading,\n      isShown: isOpen || isVisible,\n      prefix: CLASSNAME,\n      size: size\n    })),\n    style: {\n      zIndex: zIndex\n    }\n  }), React.createElement(\"div\", {\n    className: \"\".concat(CLASSNAME, \"__overlay\")\n  }), React.createElement(\"section\", _extends({\n    className: \"\".concat(CLASSNAME, \"__container\"),\n    role: \"dialog\",\n    \"aria-modal\": \"true\"\n  }, dialogProps), React.createElement(ClickAwayProvider, {\n    callback: !preventAutoClose && handleClose,\n    refs: clickAwayRefs\n  }, React.createElement(\"div\", {\n    className: \"\".concat(CLASSNAME, \"__wrapper\"),\n    ref: wrapperRef\n  }, (header || headerChildContent) && React.createElement(\"header\", _extends({}, headerChildProps, {\n    className: classnames(\"\".concat(CLASSNAME, \"__header\"), (forceHeaderDivider || hasTopIntersection) && \"\".concat(CLASSNAME, \"__header--has-divider\"), headerChildProps === null || headerChildProps === void 0 ? void 0 : headerChildProps.className)\n  }), header, headerChildContent), React.createElement(\"div\", {\n    ref: mergeRefs(contentRef, localContentRef),\n    className: \"\".concat(CLASSNAME, \"__content\")\n  }, React.createElement(\"div\", {\n    className: \"\".concat(CLASSNAME, \"__sentinel \").concat(CLASSNAME, \"__sentinel--top\"),\n    ref: setSentinelTop\n  }), content, React.createElement(\"div\", {\n    className: \"\".concat(CLASSNAME, \"__sentinel \").concat(CLASSNAME, \"__sentinel--bottom\"),\n    ref: setSentinelBottom\n  })), (footer || footerChildContent) && React.createElement(\"footer\", _extends({}, footerChildProps, {\n    className: classnames(\"\".concat(CLASSNAME, \"__footer\"), (forceFooterDivider || hasBottomIntersection) && \"\".concat(CLASSNAME, \"__footer--has-divider\"), footerChildProps === null || footerChildProps === void 0 ? void 0 : footerChildProps.className)\n  }), footer, footerChildContent), isLoading && React.createElement(\"div\", {\n    className: \"\".concat(CLASSNAME, \"__progress-overlay\")\n  }, React.createElement(Progress, {\n    variant: ProgressVariant.circular\n  })))))), document.body) : null;\n});\nDialog.displayName = COMPONENT_NAME;\nDialog.className = CLASSNAME;\nDialog.defaultProps = DEFAULT_PROPS;\nexport { Dialog as D };","map":{"version":3,"sources":["../../../src/hooks/useIntersectionObserver.tsx","../../../src/components/dialog/Dialog.tsx"],"names":["intersections","setIntersections","useState","useEffect","elements","observer","entry","entries","element","isHeader","isComponent","isFooter","COMPONENT_NAME","CLASSNAME","getRootClassName","DEFAULT_PROPS","size","Size","big","Dialog","forwardRef","children","className","header","focusElement","forceFooterDivider","forceHeaderDivider","footer","isLoading","isOpen","onClose","parentElement","contentRef","preventAutoClose","zIndex","dialogProps","onVisibilityChange","forwardedProps","props","handleClose","useCallbackOnEscape","wrapperRef","useRef","localContentRef","useFocusTrap","useDisableBodyScroll","sentinelTop","setSentinelTop","sentinelBottom","setSentinelBottom","useIntersectionObserver","threshold","hasTopIntersection","hasBottomIntersection","headerChild","footerChild","content","useMemo","partitionMulti","Children","headerChildProps","headerChildContent","footerChildProps","footerChildContent","isVisible","useDelayedVisibility","Boolean","clickAwayRefs","createPortal","ref","classNames","handleBasicClasses","isHidden","isShown","prefix","mergeRefs","ProgressVariant","circular","document"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react';\n\nexport type Intersections<T> = Map<T, IntersectionObserverEntry>;\n\n/**\n * Convenient hook to create interaction observers.\n *\n * @param elements Elements to observe.\n * @param options  IntersectionObserver options.\n * @return Map of intersections.\n */\nexport function useIntersectionObserver<T extends Element>(\n    elements: Array<T | null | undefined>,\n    options?: IntersectionObserverInit,\n): Intersections<T> {\n    const [intersections, setIntersections] = useState<Intersections<T>>(() => new Map());\n\n    useEffect(\n        () => {\n            if (elements.length < 1 || !elements.some(Boolean)) {\n                return undefined;\n            }\n\n            const observer = new IntersectionObserver((entries) => {\n                for (const entry of entries) {\n                    intersections.set(entry.target as T, entry);\n                }\n                setIntersections(new Map(intersections));\n            }, options);\n\n            for (const element of elements) {\n                if (element) {\n                    observer.observe(element);\n                }\n            }\n            return () => observer.disconnect();\n        },\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [...elements],\n    );\n\n    return intersections;\n}\n","import React, { Children, forwardRef, ReactElement, ReactNode, RefObject, useMemo, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\n\nimport classNames from 'classnames';\n\nimport { Progress, ProgressVariant, Size } from '@lumx/react';\n\nimport { DIALOG_TRANSITION_DURATION, DOCUMENT } from '@lumx/react/constants';\nimport { useCallbackOnEscape } from '@lumx/react/hooks/useCallbackOnEscape';\nimport { useFocusTrap } from '@lumx/react/hooks/useFocusTrap';\nimport { useIntersectionObserver } from '@lumx/react/hooks/useIntersectionObserver';\nimport {\n    Comp,\n    GenericProps,\n    getRootClassName,\n    handleBasicClasses,\n    isComponent,\n    partitionMulti,\n} from '@lumx/react/utils';\nimport { ClickAwayProvider } from '@lumx/react/utils/ClickAwayProvider';\nimport { mergeRefs } from '@lumx/react/utils/mergeRefs';\n\nimport { useDelayedVisibility } from '@lumx/react/hooks/useDelayedVisibility';\nimport { useDisableBodyScroll } from '@lumx/react/hooks/useDisableBodyScroll';\n\n/**\n * Defines the props of the component.\n */\nexport interface DialogProps extends GenericProps {\n    /** Footer content. */\n    footer?: ReactNode;\n    /** Whether the divider between the dialog content and the footer is always displayed (instead of showing it on scroll). */\n    forceFooterDivider?: boolean;\n    /** Header content. */\n    header?: ReactNode;\n    /** Whether the divider between the dialog content and the footer is always displayed (instead of showing it on scroll). */\n    forceHeaderDivider?: boolean;\n    /** Whether the indefinite progress indicator over the dialog content is displayed or not. */\n    isLoading?: boolean;\n    /** Whether the component is open or not. */\n    isOpen?: boolean;\n    /** Reference to the parent element that triggered modal opening (will get back focus on close). */\n    parentElement?: RefObject<HTMLElement>;\n    /** Reference to the dialog content element. */\n    contentRef?: RefObject<HTMLDivElement>;\n    /** Reference to the of the element that should get the focus when the dialogs opens. By default, the first child will take focus. */\n    focusElement?: RefObject<HTMLElement>;\n    /** Whether to keep the dialog open on clickaway or escape press. */\n    preventAutoClose?: boolean;\n    /** Size variant. */\n    size?: DialogSizes;\n    /** Z-axis position. */\n    zIndex?: number;\n    /** Z-axis position. */\n    dialogProps?: GenericProps;\n    /** On close callback. */\n    onClose?(): void;\n    /** Callback called when the open animation starts and the close animation finishes. */\n    onVisibilityChange?(isVisible: boolean): void;\n}\n\nexport type DialogSizes = Extract<Size, 'tiny' | 'regular' | 'big' | 'huge'>;\n\nconst isHeader = isComponent('header');\nconst isFooter = isComponent('footer');\n\n/**\n * Component display name.\n */\nconst COMPONENT_NAME = 'Dialog';\n\n/**\n * Component default class name and class prefix.\n */\nconst CLASSNAME = getRootClassName(COMPONENT_NAME);\n\n/**\n * Component default props.\n */\nconst DEFAULT_PROPS: Partial<DialogProps> = {\n    size: Size.big,\n};\n\n/**\n * Dialog component.\n *\n * @param  props Component props.\n * @param  ref   Component ref.\n * @return React element.\n */\nexport const Dialog: Comp<DialogProps, HTMLDivElement> = forwardRef((props, ref) => {\n    if (!DOCUMENT) {\n        // Can't render in SSR.\n        return null;\n    }\n\n    const {\n        children,\n        className,\n        header,\n        focusElement,\n        forceFooterDivider,\n        forceHeaderDivider,\n        footer,\n        isLoading,\n        isOpen,\n        onClose,\n        parentElement,\n        contentRef,\n        preventAutoClose,\n        size,\n        zIndex,\n        dialogProps,\n        onVisibilityChange,\n        ...forwardedProps\n    } = props;\n\n    const handleClose = onClose\n        ? () => {\n              onClose();\n              // Focus the parent element on close.\n              if (parentElement && parentElement.current) {\n                  parentElement.current.focus();\n              }\n          }\n        : undefined;\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    useCallbackOnEscape(handleClose, isOpen && !preventAutoClose);\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const wrapperRef = useRef<HTMLDivElement>(null);\n    /**\n     * Since the `contentRef` comes from the parent and is optional,\n     * we need to create a stable contentRef that will always be available.\n     */\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const localContentRef = useRef<HTMLDivElement>(null);\n    // Handle focus trap.\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    useFocusTrap(wrapperRef.current, focusElement?.current);\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    useDisableBodyScroll(isOpen && localContentRef.current);\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const [sentinelTop, setSentinelTop] = useState<Element | null>(null);\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const [sentinelBottom, setSentinelBottom] = useState<Element | null>(null);\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const intersections = useIntersectionObserver([sentinelTop, sentinelBottom], {\n        threshold: [0, 1],\n    });\n\n    const hasTopIntersection = sentinelTop && !(intersections.get(sentinelTop)?.isIntersecting ?? true);\n    const hasBottomIntersection = sentinelBottom && !(intersections.get(sentinelBottom)?.isIntersecting ?? true);\n\n    // Separate header, footer and dialog content from children.\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const [[headerChild], [footerChild], content] = useMemo(\n        () => partitionMulti(Children.toArray(children), [isHeader, isFooter]),\n        [children],\n    );\n    const headerChildProps = (headerChild as ReactElement)?.props;\n    const headerChildContent = headerChildProps?.children;\n    const footerChildProps = (footerChild as ReactElement)?.props;\n    const footerChildContent = footerChildProps?.children;\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const isVisible = useDelayedVisibility(Boolean(isOpen), DIALOG_TRANSITION_DURATION, onVisibilityChange);\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const clickAwayRefs = useRef([wrapperRef]);\n\n    return isOpen || isVisible\n        ? createPortal(\n              <div\n                  ref={ref}\n                  {...forwardedProps}\n                  className={classNames(\n                      className,\n                      handleBasicClasses({\n                          isHidden: !isOpen,\n                          isLoading,\n                          isShown: isOpen || isVisible,\n                          prefix: CLASSNAME,\n                          size,\n                      }),\n                  )}\n                  style={{ zIndex }}\n              >\n                  <div className={`${CLASSNAME}__overlay`} />\n\n                  <section className={`${CLASSNAME}__container`} role=\"dialog\" aria-modal=\"true\" {...dialogProps}>\n                      <ClickAwayProvider callback={!preventAutoClose && handleClose} refs={clickAwayRefs}>\n                          <div className={`${CLASSNAME}__wrapper`} ref={wrapperRef}>\n                              {(header || headerChildContent) && (\n                                  <header\n                                      {...headerChildProps}\n                                      className={classNames(\n                                          `${CLASSNAME}__header`,\n                                          (forceHeaderDivider || hasTopIntersection) &&\n                                              `${CLASSNAME}__header--has-divider`,\n                                          headerChildProps?.className,\n                                      )}\n                                  >\n                                      {header}\n                                      {headerChildContent}\n                                  </header>\n                              )}\n\n                              <div ref={mergeRefs(contentRef, localContentRef)} className={`${CLASSNAME}__content`}>\n                                  <div\n                                      className={`${CLASSNAME}__sentinel ${CLASSNAME}__sentinel--top`}\n                                      ref={setSentinelTop}\n                                  />\n\n                                  {content}\n\n                                  <div\n                                      className={`${CLASSNAME}__sentinel ${CLASSNAME}__sentinel--bottom`}\n                                      ref={setSentinelBottom}\n                                  />\n                              </div>\n\n                              {(footer || footerChildContent) && (\n                                  <footer\n                                      {...footerChildProps}\n                                      className={classNames(\n                                          `${CLASSNAME}__footer`,\n                                          (forceFooterDivider || hasBottomIntersection) &&\n                                              `${CLASSNAME}__footer--has-divider`,\n                                          footerChildProps?.className,\n                                      )}\n                                  >\n                                      {footer}\n                                      {footerChildContent}\n                                  </footer>\n                              )}\n\n                              {isLoading && (\n                                  <div className={`${CLASSNAME}__progress-overlay`}>\n                                      <Progress variant={ProgressVariant.circular} />\n                                  </div>\n                              )}\n                          </div>\n                      </ClickAwayProvider>\n                  </section>\n              </div>,\n              document.body,\n          )\n        : null;\n});\nDialog.displayName = COMPONENT_NAME;\nDialog.className = CLASSNAME;\nDialog.defaultProps = DEFAULT_PROPS;\n"]},"metadata":{},"sourceType":"module"}